# Consultly - Backend API

![NestJS](https://img.shields.io/badge/nestjs-%23E0234E.svg?style=for-the-badge&logo=nestjs&logoColor=white)
![TypeScript](https://img.shields.io/badge/typescript-%23007ACC.svg?style=for-the-badge&logo=typescript&logoColor=white)
![MongoDB](https://img.shields.io/badge/MongoDB-%234ea94b.svg?style=for-the-badge&logo=mongodb&logoColor=white)
![Redis](https://img.shields.io/badge/redis-%23DD0031.svg?style=for-the-badge&logo=redis&logoColor=white)
![Docker](https://img.shields.io/badge/docker-%230db7ed.svg?style=for-the-badge&logo=docker&logoColor=white)

A robust, scalable, and secure backend application for the **Consultly** platform, built with [NestJS](https://nestjs.com/). This system handles user matchmaking, real-time communication, profile management, and administrative operations with a focus on performance and security.

## ğŸš€ Key Features

- **Advanced Authentication**:
  - JWT-based secure authentication.
  - OTP verification (Email & Phone).
  - Multi-device session management with device fingerprinting.
  - Role-Based Access Control (RBAC).
- **User Management**:
  - Comprehensive profile management (Personal, Religious, Education, Family).
  - Profile privacy settings and image moderation.
- **Real-time Communication**:
  - Instant messaging with Socket.IO.
  - Online status and typing indicators.
  - File and image sharing in chat.
- **Matchmaking System**:
  - Intelligent partner preference matching.
  - Saved matches and interest requests.
- **Technical Highlights**:
  - **Queue Management**: BullMQ backed by Redis for asynchronous tasks (Emails, Notifications).
  - **Caching**: Redis for high-performance data retrieval.
  - **Storage**: AWS S3 integration for secure media storage.
  - **Logging**: Centralized logging with Winston and Loki.
  - **Security**: Throttling, Helmet, Compression, and validation pipes.

## ğŸ›  Technology Stack

- **Core**: [NestJS](https://nestjs.com/) (Node.js framework)
- **Language**: TypeScript
- **Database**: MongoDB (via Mongoose)
- **Caching & Queues**: Redis, BullMQ
- **Real-time**: Socket.IO
- **Storage**: AWS S3 (@aws-sdk/client-s3)
- **Documentation**: Swagger (OpenAPI), Compodoc
- **Containerization**: Docker, Docker Compose

## ğŸ“‹ Prerequisites

Ensure you have the following installed:

- [Node.js](https://nodejs.org/) (v22.0.0 or higher)
- [pnpm](https://pnpm.io/) or [yarn](https://yarnpkg.com/)
- [Redis](https://redis.io/)
- [MongoDB](https://www.mongodb.com/)

## âš™ï¸ Installation & Setup

1.  **Clone the repository**

    ```bash
    git clone https://gitlab.webskitters.com/node/consultly.git
    cd consultly
    ```

2.  **Install dependencies**

    ```bash
    pnpm install
    ```

3.  **Environment Configuration**
    Copy the example environment file and update the values:

    ```bash
    cp .env.example .env
    ```

    Update `.env` with your credentials:

    ```env
    MONGO_URI="mongodb://localhost:27017/consultly"
    REDIS_HOST=localhost
    JWT_SECRET="your-secure-secret"
    AWS_ACCESS_KEY_ID="your-aws-key"
    ...
    ```

4.  **Run the Application**
    - **Development**:
      ```bash
      pnpm dev
      # or
      pnpm start:dev
      ```
    - **Production**:
      ```bash
      pnpm build
      pnpm start:prod
      ```

## ğŸ³ Docker Setup

Run the application using Docker Compose for a consistent environment.

```bash
# Start services
docker-compose up -d

# Stop services
docker-compose down
```

## ğŸ“š API Documentation

Autogenerated API documentation is available via Swagger.

- **Swagger UI**: `http://localhost:3001/api/docs` (default URL)
- **Compodoc**: `pnpm doc` then visit `http://localhost:3001`

## ğŸ“ Project Structure

```
src/
â”œâ”€â”€ common/             # Shared decorators, filters, guards, interceptors
â”œâ”€â”€ config/             # Environment configuration mapping
â”œâ”€â”€ modules/            # Feature modules (Auth, User, Chat, etc.)
â”‚   â”œâ”€â”€ auth/           # Authentication logic
â”‚   â”œâ”€â”€ chat/           # Real-time chat module
â”‚   â”œâ”€â”€ user/           # User profile management
â”‚   â””â”€â”€ ...
â”œâ”€â”€ providers/          # Global providers/services
â””â”€â”€ main.ts             # Application entry point
```

## ğŸ§ª Testing

```bash
# Unit tests
pnpm test

# e2e tests
pnpm test:e2e

# Test coverage
pnpm test:cov
```

## ğŸ¤ Contributing

1.  Fork the repository.
2.  Create your feature branch (`git checkout -b feature/amazing-feature`).
3.  Commit your changes (`git commit -m 'Add some amazing feature'`).
4.  Push to the branch (`git push origin feature/amazing-feature`).
5.  Open a Merge Request.

## ğŸ“„ License

This project is proprietary and unlicensed.
